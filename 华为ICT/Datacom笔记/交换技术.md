# 以太网交换基础
## 以太网协议
以太网是局域网（LAN）的协议，采用CSMA/CD的方法

**冲突域**
![[Pasted image 20231020102131.png]]
**广播域**
![[Pasted image 20231020102150.png]]
**以太网卡**
一块网卡包括OSI 模型的两个层，物理层和数据链路层

网卡的功能主要有两个：
1. 将电脑的数据封装为帧，并通过网线(对无线网络来说就是电磁波)将数据发送到网络上去
2. 接收网络上其它设备传过来的帧，并将帧重新组合成数据，发送到所在的电脑中

## 以太网帧
![[Pasted image 20231020102558.png]]
详细可见计网部分的以太网帧：
![[Pasted image 20231018101644.png]]

**MAC地址**
![[Pasted image 20231020102947.png]]
单播就是点对点发送
组播是向部分设备发送
广播是向所有设备发送

## 以太网交换机
以太网二层交换机转发数据的端口都是以太网口，并且只能够针对数据的二层头部 (以太网数据帧头) 中的MAC地址进行寻址并转发数据。

其他特性可在计网中查询

# VLAN
**VLAN基本概念**
VLAN就是将一个物理交换机划分为多个虚拟交换机，类似下图：
![[Pasted image 20231020110708.png]]

交换机之间需要进行帧的交换，就涉及到如何识别不同VLAN的帧：
![[Pasted image 20231020110800.png]]

我们在帧中加入Tag字段，从而识别不同VLAN。
![[Pasted image 20231020110826.png]]

**VLAN划分方式**
![[Pasted image 20231020111146.png]]

**VLAN中的接口**
![[Pasted image 20231020112745.png]]
Access接口一般用于和不能识别Tag的用户终端（如用户主机、服务器）相连：用户终端无法识别何添加VLAN ID，因而需要由交换机完成。

Trunk接口一般用于连接交换机、路由器、AP：负责将带有tag的帧进行相互传递

Hybrid（杂交）接口既可以用于连接不能识别Tag的用户终端（如用户主机、服务器）和网络设备（如Hub），也可以用于连接交换机、路由器。

一般还是Access和Trunk两种接口用的多。

**VLAN应用**
![[Pasted image 20231020113816.png]]
![[Pasted image 20231020113827.png]]

# 链路聚合、堆叠和集群
## 网络可靠性
![[Pasted image 20231021120134.png]]
本节主要讲述链路可靠性的实现。

## 链路聚合技术
**链路聚合技术基本原理**
![[Pasted image 20231021120252.png]]
![[Pasted image 20231021120304.png]]
其中成员接口指的是聚合后拥有的接口。活动接口指的是当前能够使用的接口。

**链路聚合模式**
链路聚合模式分为手动模式和LACP模式。手动模式用于老旧设备，只能通过管理员进行配置，出现故障也只能由管理员进行处理。而LACP模式可以自行配置、自主处理故障。

**LACP模式**
![[Pasted image 20231021120525.png]]
1. 首先根据设备优先级选出主动端，其中值越小优先级越高。主动端将选择活动接口，被动端将接受主动端选择的活动接口。
2. 选出主动端后，两端都会以主动端的接口优先级来选择活动接口，优先级高的接口将优先被选为活动接口。接口LACP优先级值越小，优先级越高。
3. 主动端将选举的活动接口结果告知被动端，被动端明确本端的活动接口，同时对应的链路成为活动链路
4. 至此，Eth-Trunk的活动链路选举过程完成


**关于最大接口数**：
![[Pasted image 20231021120757.png]]
![[Pasted image 20231021120815.png]]


**负载分担**
![[Pasted image 20231021121137.png]]

## 堆叠与集群
![[Pasted image 20231021121220.png]]
- 逻辑上一台设备，简化运维，方便管理。
- 一台物理设备故障，其他设备可以接管转发、控制平台，避免了单点故障
- 跨设备的链路聚合，物理上的无环网络，无需再部署STP
- 链路聚合中的链路全部有效使用，链路利用率100%。

![[Pasted image 20231021121339.png]]