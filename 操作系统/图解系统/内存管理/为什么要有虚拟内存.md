# 虚拟内存
物理内存是有限的，而操作系统又是多任务的操作系统，我们就需要让每个进程感觉自己拥有一块独立的内存，这就引出了虚拟内存。

**操作系统会提供一种机制，将不同进程的虚拟地址和不同内存的物理地址映射起来。**

如果程序要访问虚拟地址的时候，由操作系统转换成不同的物理地址，这样不同的进程运行的时候，写入的是不同的物理地址，这样就不会冲突了。

操作系统有两种方式管理虚拟内存和物理内存之间的关系：
- 内存分段
- 内存分页

# 内存分段
程序是由若干个逻辑分段组成的，如可由代码分段、数据分段、栈段、堆段组成。**不同的段是有不同的属性的，所以就用分段（_Segmentation_）的形式把这些段分离出来**

分段机制下的虚拟地址由两部分组成，**段选择因子**和**段内偏移量**：
- 段选择因子包含段号，段号可以在段表中找到该段的描述符，其中包含段基地址、段界限等信息
- 段内偏移值是该虚拟地址对应的物理地址相对于段基地址的偏移量
![[Pasted image 20231226111044.png]]

## 不足之处
内存分段会造成两个问题：
- 内存碎片：由于每个程序不同端的大小不同，占据的空间也就不同，等到端进行释放后，就可能出现碎片空间，且无法被其他程序端利用。
- 内存交换效率低：解决内存碎片就需要重新整理内存，通过在硬盘上设置交换空间，将内存中的段写到硬盘上，再重新分配内存空间，这样就实现了内存空间的整理。但这样做的问题就是读写硬盘效率低。

# 内存分页

