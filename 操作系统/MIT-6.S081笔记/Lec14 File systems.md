说实话这一节的课程内容讲的不是很好，我觉得看教材+代码是比较好的方式。因而下面从教材+代码的角度进行笔记整理。

# 文件系统面对的挑战
- 文件系统需要磁盘上的数据结构来表示目录和文件名称树，记录保存每个文件内容的块的标识，以及记录磁盘的哪些区域是空闲的。
- 文件系统必须支持崩溃恢复（crash recovery）。也就是说，如果发生崩溃（例如，电源故障），文件系统必须在重新启动后仍能正常工作。风险在于崩溃可能会中断一系列更新，并使磁盘上的数据结构不一致（例如，一个块在某个文件中使用但同时仍被标记为空闲）。
- 不同的进程可能同时在文件系统上运行，因此文件系统代码必须协调以保持不变量。
- 访问磁盘的速度比访问内存慢几个数量级，因此文件系统必须保持常用块的内存缓存。

# 文件系统层次
|文件描述符（File descriptor）|
|---|
|路径名（Pathname）|
|目录（Directory）|
|索引结点（Inode）|
|日志（Logging）|
|缓冲区高速缓存（Buffer cache）|
|磁盘（Disk）|

xv6文件系统实现分为七层：
- 磁盘层读取和写入virtio硬盘上的块
- 缓冲区高速缓存层缓存磁盘块并同步对它们的访问
- 日志记录层负责保证崩溃时的恢复
- 索引节点为每个文件提供索引，并保存数据的指针
- 目录层将每个目录实现为一种特殊的索引结点，其内容是一系列目录项，每个目录项包含一个文件名和索引号
- 路径名层提供了分层路径名，并通过递归查找来解析它们
- 文件描述符层使用文件系统接口抽象了许多Unix资源

