# 操作系统虚拟机
操作系统的核心在裸机上运行，在裸机上配置了操作系统后，就构成了操作系统虚拟机。用户通过一组命令与操作系统虚拟机打交道：
- 操作命令：键盘命令、图形化界面等
- 系统调用：操作系统提供的程序接口

# 操作系统的组织结构
操作系统作为一个大型系统软件，包含多个功能模块，这些模块之间如何调用，如何对外提供接口，这就是操作系统的结构问题。

## 操作系统的结构分类（了解即可）
- 单体结构
- 模块结构
- 可扩展内核结构
- 层次结构

## 运行时的组织结构
- 系统调用方式（宏内核）
- 客户/服务器方式（微内核）
![[Pasted image 20231115104753.png]]

# 处理机的特权级
## 处理机的态及分类
操作系统至少分为两种状态：管态和用户态
- 管态（Supervisor Mode）：操作系统内核程序执行时机器所处的状态，CPU可以使用全部机器指令，可以使用全部资源
- 用户态（User Mode）：用户程序执行时机器所处的状态，禁止使用特权指令

为区分操作系统状态，需要有硬件来记录，计算机状态寄存器中用于记录。

## 特权指令
特权指令涉及以下几个方面：
- 改变机器状态的指令
- 修改特殊寄存器的指令
- 涉及外部设备输入/输出的指令

在以下情况，由用户态自动转向管态：
- 执行系统调用
- 用户程序执行时，发生中断
- 用户程序执行时产生错误
- 用户态下企图执行特权指令

# 中断及其处理
中断用于中止系统当前执行的程序，转而执行中断所指的事件，然后再返回断点继续执行。

中断分类：（了解即可）
- 输入输出中断
- 外部中断
- 硬件中断
- 程序性中断

## 中断进入
1. 保护现场和恢复现场。
2. 程序状态字
3. 中断响应：CPU发现有中断请求，中止现行程序的运行，转而执行中断处理程序

## 软件中断处理
![[Pasted image 20231115112550.png]]



